<!doctype html>
<html lang="en">
    <head>
        <title>Face tracker</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="./styles/default.css">
    </head>
    <body>
        <div id="content">
            <h2>Example</h2>

            <div id="container">
                <video id="videoel" width="600" height="400" preload="auto" loop></video>
                <canvas id="clmtrackerCanvas" class ="overlay_canvas" width="600" height="400"></canvas>
                <canvas id="webglCanvas" class ="overlay_canvas" width="600" height="400"></canvas>
            </div>
            <p>Printing coordinates of the first 10 points in facial features:</p>

            <p id="positions"></p>
        </div>
        <script id="vertexShader" type="x-shader/x-vertex">
            uniform mat4 Mproj;
            uniform mat4 Mcam;

            attribute vec2 uv;
            attribute vec3 vert_position;
            attribute vec3 normal; // will generate warning because normal is not used now

            varying vec2 geom_texCoord;

            void main() {
                gl_Position = Mproj * Mcam * vec4(vert_position, 1.0);
                geom_texCoord = uv;
            }
        </script>

        <script id="fragmentShader" type="x-shader/x-fragment">
            precision highp float;

            varying vec2 geom_texCoord;

            uniform sampler2D texture;

            void main() {
                gl_FragColor = texture2D(texture, geom_texCoord);
            }
        </script>
        <script src="./js/occluder_mapping.js"></script>
        <script src="js/jquery-3.1.1.min.js"></script>
        <script src="js/jquery-ui.min.js"></script>
        <script src="js/gl-matrix-min.js"></script>
        <script src="js/preloadjs-0.6.2.min.js"></script>
        <script src="js/webgl-obj-loader.js"></script>
        <script src="./global.js"></script>
        <script src="./webgl.js"></script>
        <script src="./viewer.js"></script>

        <script src="./js/utils.js"></script>
        <script src="./js/clmtrackr.js"></script>
        <script src="./js/model_pca_20_svm.js"></script>
        <script src="./js/camera_stream.js"></script>
        <script src="./js/helper_information.js"></script>
        <script>
            var drawFeaturePoints = false;
            var vid = $('#videoel')[0];
            init_camera_stream(vid);

            var ctracker = new clm.tracker();
            ctracker.init(pModel);
            ctracker.start(vid);

            init_helper_information($('#positions')[0]);

            // Draw feature points
            if (drawFeaturePoints) {
                var canvasInput = $('#clmtrackerCanvas')[0];
                var cc = canvasInput.getContext('2d');
                function drawLoop() {
                    cc.clearRect(0, 0, canvasInput.width, canvasInput.height);
                    ctracker.draw(canvasInput);
                    requestAnimationFrame(drawLoop);
                }
                drawLoop();
            }
        </script>
    </body>
</html>
